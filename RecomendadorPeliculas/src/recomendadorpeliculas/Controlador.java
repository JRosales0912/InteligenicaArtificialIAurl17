/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package recomendadorpeliculas;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

/**
 *
 * @author Cesar
 */
public class Controlador {
    private final String tabla = "Data";
    public List<MovieData> recuperarTodas(Connection conexion, int año) throws SQLException{
        List<MovieData> movies = new ArrayList<>();
        try{
            PreparedStatement consulta;
            if (año <= 1995) {
                consulta = conexion.prepareStatement("SELECT * FROM " + this.tabla + " WHERE _title_year < 1998 OR _title_year = 0");
            } else if (año >= 1996 && año <= 2005){
                consulta = conexion.prepareStatement("SELECT * FROM " + this.tabla + " WHERE (_title_year BETWEEN " + String.valueOf(año - 3) +  " AND " + String.valueOf(año + 3) +  ") OR _title_year = 0");
            } else
            {
                consulta = conexion.prepareStatement("SELECT * FROM " + this.tabla + " WHERE (_title_year BETWEEN " + String.valueOf(año - 2) +  " AND " + String.valueOf(año + 2) +  ") OR _title_year = 0");
            }
            
            ResultSet resultado = consulta.executeQuery();
            while(resultado.next()){
               movies.add(new MovieData(resultado.getInt("_ID"),resultado.getString("_movie_title"),resultado.getString("_director_name"),resultado.getString("_actor_1_name"),resultado.getString("_actor_2_name"),resultado.getString("_actor_3_name"),resultado.getInt("_duration"),resultado.getInt("_gross"),resultado.getString("_movie_imdb_link"),resultado.getString("_language"),resultado.getString("_country"),resultado.getString("_content_rating"),resultado.getInt("_title_year"),resultado.getInt("_director_facebook_likes"),resultado.getInt("_cast_total_facebook_likes"),resultado.getInt("_movie_facebook_likes"),resultado.getDouble("_imdb_score"),resultado.getInt("_Action"),resultado.getInt("_Adventure"),resultado.getInt("_Fantasy"),resultado.getInt("_Sci_Fi"),resultado.getInt("_Thriller"),resultado.getInt("_Documentary"),resultado.getInt("_Romance"),resultado.getInt("_Animation"),resultado.getInt("_Comedy"),resultado.getInt("_Family"),resultado.getInt("_Musical"),resultado.getInt("_Mystery"),resultado.getInt("_Western"),resultado.getInt("_Drama"),resultado.getInt("_History"),resultado.getInt("_Sport"),resultado.getInt("_Crime"),resultado.getInt("_Horror"),resultado.getInt("_War"),resultado.getInt("_Biography"),resultado.getInt("_Music"),resultado.getInt("_Game_Show"),resultado.getInt("_Reality_TV"),resultado.getInt("_News"),resultado.getInt("_Short"),resultado.getInt("_Film_Noir"),resultado.getInt("_Approved"),resultado.getInt("_G"),resultado.getInt("_GP"),resultado.getInt("_M"),resultado.getInt("_NC_17"),resultado.getInt("_Not_Rated"),resultado.getInt("_Passed"),resultado.getInt("_PG"),resultado.getInt("_PG_13"),resultado.getInt("_R"),resultado.getInt("_TV_14"),resultado.getInt("_TV_G"),resultado.getInt("_TV_MA"),resultado.getInt("_TV_PG"),resultado.getInt("_TV_Y"),resultado.getInt("_TV_Y7"),resultado.getInt("_Unrated"),resultado.getInt("_X"),resultado.getInt("_1916"),resultado.getInt("_1920"),resultado.getInt("_1925"),resultado.getInt("_1927"),resultado.getInt("_1929"),resultado.getInt("_1930"),resultado.getInt("_1932"),resultado.getInt("_1933"),resultado.getInt("_1934"),resultado.getInt("_1935"),resultado.getInt("_1936"),resultado.getInt("_1937"),resultado.getInt("_1938"),resultado.getInt("_1939"),resultado.getInt("_1940"),resultado.getInt("_1941"),resultado.getInt("_1942"),resultado.getInt("_1943"),resultado.getInt("_1944"),resultado.getInt("_1945"),resultado.getInt("_1946"),resultado.getInt("_1947"),resultado.getInt("_1948"),resultado.getInt("_1949"),resultado.getInt("_1950"),resultado.getInt("_1951"),resultado.getInt("_1952"),resultado.getInt("_1953"),resultado.getInt("_1954"),resultado.getInt("_1955"),resultado.getInt("_1956"),resultado.getInt("_1957"),resultado.getInt("_1958"),resultado.getInt("_1959"),resultado.getInt("_1960"),resultado.getInt("_1961"),resultado.getInt("_1962"),resultado.getInt("_1963"),resultado.getInt("_1964"),resultado.getInt("_1965"),resultado.getInt("_1966"),resultado.getInt("_1967"),resultado.getInt("_1968"),resultado.getInt("_1969"),resultado.getInt("_1970"),resultado.getInt("_1971"),resultado.getInt("_1972"),resultado.getInt("_1973"),resultado.getInt("_1974"),resultado.getInt("_1975"),resultado.getInt("_1976"),resultado.getInt("_1977"),resultado.getInt("_1978"),resultado.getInt("_1979"),resultado.getInt("_1980"),resultado.getInt("_1981"),resultado.getInt("_1982"),resultado.getInt("_1983"),resultado.getInt("_1984"),resultado.getInt("_1985"),resultado.getInt("_1986"),resultado.getInt("_1987"),resultado.getInt("_1988"),resultado.getInt("_1989"),resultado.getInt("_1990"),resultado.getInt("_1991"),resultado.getInt("_1992"),resultado.getInt("_1993"),resultado.getInt("_1994"),resultado.getInt("_1995"),resultado.getInt("_1996"),resultado.getInt("_1997"),resultado.getInt("_1998"),resultado.getInt("_1999"),resultado.getInt("_2000"),resultado.getInt("_2001"),resultado.getInt("_2002"),resultado.getInt("_2003"),resultado.getInt("_2004"),resultado.getInt("_2005"),resultado.getInt("_2006"),resultado.getInt("_2007"),resultado.getInt("_2008"),resultado.getInt("_2009"),resultado.getInt("_2010"),resultado.getInt("_2011"),resultado.getInt("_2012"),resultado.getInt("_2013"),resultado.getInt("_2014"),resultado.getInt("_2015"),resultado.getInt("_2016"),resultado.getInt("_Aboriginal"),resultado.getInt("_Arabic"),resultado.getInt("_Aramaic"),resultado.getInt("_Bosnian"),resultado.getInt("_Cantonese"),resultado.getInt("_Chinese"),resultado.getInt("_Czech"),resultado.getInt("_Danish"),resultado.getInt("_Dari"),resultado.getInt("_Dutch"),resultado.getInt("_Dzongkha"),resultado.getInt("_English"),resultado.getInt("_Filipino"),resultado.getInt("_French"),resultado.getInt("_German"),resultado.getInt("_Greek_"),resultado.getInt("_Hebrew_"),resultado.getInt("_Hindi"),resultado.getInt("_Hungarian"),resultado.getInt("_Icelandic"),resultado.getInt("_Indonesian"),resultado.getInt("_Italian"),resultado.getInt("_Japanese"),resultado.getInt("_Kannada"),resultado.getInt("_Kazakh"),resultado.getInt("_Korean"),resultado.getInt("_Mandarin"),resultado.getInt("_Maya"),resultado.getInt("_Mongolian"),resultado.getInt("_None"),resultado.getInt("_Norwegian"),resultado.getInt("_Panjabi"),resultado.getInt("_Persian"),resultado.getInt("_Polish"),resultado.getInt("_Portuguese"),resultado.getInt("_Romanian"),resultado.getInt("_Russian"),resultado.getInt("_Slovenian"),resultado.getInt("_Spanish"),resultado.getInt("_Swahili"),resultado.getInt("_Swedish"),resultado.getInt("_Tamil"),resultado.getInt("_Telugu"),resultado.getInt("_Thai"),resultado.getInt("_Urdu"),resultado.getInt("_ZuluNULL")));
            }
        }catch(SQLException ex){
           throw new SQLException(ex);
        }
        return movies;
    }
    
    public MovieData recuperarPorId(Connection conexion, int id) throws SQLException {
      MovieData movie = null;
      try{
         PreparedStatement consulta = conexion.prepareStatement("SELECT * FROM " + this.tabla + " WHERE ID = ?" );
         consulta.setInt(1, id);
         ResultSet resultado = consulta.executeQuery();
         while(resultado.next()){
            movie = new MovieData(resultado.getInt("_ID"),resultado.getString("_movie_title"),resultado.getString("_director_name"),resultado.getString("_actor_1_name"),resultado.getString("_actor_2_name"),resultado.getString("_actor_3_name"),resultado.getInt("_duration"),resultado.getInt("_gross"),resultado.getString("_movie_imdb_link"),resultado.getString("_language"),resultado.getString("_country"),resultado.getString("_content_rating"),resultado.getInt("_title_year"),resultado.getInt("_director_facebook_likes"),resultado.getInt("_cast_total_facebook_likes"),resultado.getInt("_movie_facebook_likes"),resultado.getDouble("_imdb_score"),resultado.getInt("_Action"),resultado.getInt("_Adventure"),resultado.getInt("_Fantasy"),resultado.getInt("_Sci_Fi"),resultado.getInt("_Thriller"),resultado.getInt("_Documentary"),resultado.getInt("_Romance"),resultado.getInt("_Animation"),resultado.getInt("_Comedy"),resultado.getInt("_Family"),resultado.getInt("_Musical"),resultado.getInt("_Mystery"),resultado.getInt("_Western"),resultado.getInt("_Drama"),resultado.getInt("_History"),resultado.getInt("_Sport"),resultado.getInt("_Crime"),resultado.getInt("_Horror"),resultado.getInt("_War"),resultado.getInt("_Biography"),resultado.getInt("_Music"),resultado.getInt("_Game_Show"),resultado.getInt("_Reality_TV"),resultado.getInt("_News"),resultado.getInt("_Short"),resultado.getInt("_Film_Noir"),resultado.getInt("_Approved"),resultado.getInt("_G"),resultado.getInt("_GP"),resultado.getInt("_M"),resultado.getInt("_NC_17"),resultado.getInt("_Not_Rated"),resultado.getInt("_Passed"),resultado.getInt("_PG"),resultado.getInt("_PG_13"),resultado.getInt("_R"),resultado.getInt("_TV_14"),resultado.getInt("_TV_G"),resultado.getInt("_TV_MA"),resultado.getInt("_TV_PG"),resultado.getInt("_TV_Y"),resultado.getInt("_TV_Y7"),resultado.getInt("_Unrated"),resultado.getInt("_X"),resultado.getInt("_1916"),resultado.getInt("_1920"),resultado.getInt("_1925"),resultado.getInt("_1927"),resultado.getInt("_1929"),resultado.getInt("_1930"),resultado.getInt("_1932"),resultado.getInt("_1933"),resultado.getInt("_1934"),resultado.getInt("_1935"),resultado.getInt("_1936"),resultado.getInt("_1937"),resultado.getInt("_1938"),resultado.getInt("_1939"),resultado.getInt("_1940"),resultado.getInt("_1941"),resultado.getInt("_1942"),resultado.getInt("_1943"),resultado.getInt("_1944"),resultado.getInt("_1945"),resultado.getInt("_1946"),resultado.getInt("_1947"),resultado.getInt("_1948"),resultado.getInt("_1949"),resultado.getInt("_1950"),resultado.getInt("_1951"),resultado.getInt("_1952"),resultado.getInt("_1953"),resultado.getInt("_1954"),resultado.getInt("_1955"),resultado.getInt("_1956"),resultado.getInt("_1957"),resultado.getInt("_1958"),resultado.getInt("_1959"),resultado.getInt("_1960"),resultado.getInt("_1961"),resultado.getInt("_1962"),resultado.getInt("_1963"),resultado.getInt("_1964"),resultado.getInt("_1965"),resultado.getInt("_1966"),resultado.getInt("_1967"),resultado.getInt("_1968"),resultado.getInt("_1969"),resultado.getInt("_1970"),resultado.getInt("_1971"),resultado.getInt("_1972"),resultado.getInt("_1973"),resultado.getInt("_1974"),resultado.getInt("_1975"),resultado.getInt("_1976"),resultado.getInt("_1977"),resultado.getInt("_1978"),resultado.getInt("_1979"),resultado.getInt("_1980"),resultado.getInt("_1981"),resultado.getInt("_1982"),resultado.getInt("_1983"),resultado.getInt("_1984"),resultado.getInt("_1985"),resultado.getInt("_1986"),resultado.getInt("_1987"),resultado.getInt("_1988"),resultado.getInt("_1989"),resultado.getInt("_1990"),resultado.getInt("_1991"),resultado.getInt("_1992"),resultado.getInt("_1993"),resultado.getInt("_1994"),resultado.getInt("_1995"),resultado.getInt("_1996"),resultado.getInt("_1997"),resultado.getInt("_1998"),resultado.getInt("_1999"),resultado.getInt("_2000"),resultado.getInt("_2001"),resultado.getInt("_2002"),resultado.getInt("_2003"),resultado.getInt("_2004"),resultado.getInt("_2005"),resultado.getInt("_2006"),resultado.getInt("_2007"),resultado.getInt("_2008"),resultado.getInt("_2009"),resultado.getInt("_2010"),resultado.getInt("_2011"),resultado.getInt("_2012"),resultado.getInt("_2013"),resultado.getInt("_2014"),resultado.getInt("_2015"),resultado.getInt("_2016"),resultado.getInt("_Aboriginal"),resultado.getInt("_Arabic"),resultado.getInt("_Aramaic"),resultado.getInt("_Bosnian"),resultado.getInt("_Cantonese"),resultado.getInt("_Chinese"),resultado.getInt("_Czech"),resultado.getInt("_Danish"),resultado.getInt("_Dari"),resultado.getInt("_Dutch"),resultado.getInt("_Dzongkha"),resultado.getInt("_English"),resultado.getInt("_Filipino"),resultado.getInt("_French"),resultado.getInt("_German"),resultado.getInt("_Greek_"),resultado.getInt("_Hebrew_"),resultado.getInt("_Hindi"),resultado.getInt("_Hungarian"),resultado.getInt("_Icelandic"),resultado.getInt("_Indonesian"),resultado.getInt("_Italian"),resultado.getInt("_Japanese"),resultado.getInt("_Kannada"),resultado.getInt("_Kazakh"),resultado.getInt("_Korean"),resultado.getInt("_Mandarin"),resultado.getInt("_Maya"),resultado.getInt("_Mongolian"),resultado.getInt("_None"),resultado.getInt("_Norwegian"),resultado.getInt("_Panjabi"),resultado.getInt("_Persian"),resultado.getInt("_Polish"),resultado.getInt("_Portuguese"),resultado.getInt("_Romanian"),resultado.getInt("_Russian"),resultado.getInt("_Slovenian"),resultado.getInt("_Spanish"),resultado.getInt("_Swahili"),resultado.getInt("_Swedish"),resultado.getInt("_Tamil"),resultado.getInt("_Telugu"),resultado.getInt("_Thai"),resultado.getInt("_Urdu"),resultado.getInt("_ZuluNULL"));
         }
      }catch(SQLException ex){
         throw new SQLException(ex);
      }
      return movie;
   }
}
